[gd_scene load_steps=12 format=2]

[ext_resource path="res://sound/Brr Brr Patapim Alarm.mp3" type="AudioStream" id=2]

[sub_resource type="GDScript" id=28]
script/source = "extends Control

# Declare member variables here. Examples:
# var a = 2
# var b = \"text\"

onready var panel = $Panel
var master_bus
var menu_music_bus
onready var menu_music_player = $Menu_MusicPlayer

# Called when the node enters the scene tree for the first time.
func _ready():

	master_bus = AudioServer.get_bus_index(\"Master\")
	menu_music_bus = AudioServer.get_bus_index(\"Menu_Music\")



# Called every frame. 'delta' is the elapsed time since the previous frame.
#func _process(delta):
#	pass


func _on_Back_pressed():
	var mainmenu = get_parent()      # parent คือ mainmenu ที่ใช้ Python
	var vbox = mainmenu.find_node(\"VBoxContainer\")
	vbox.show()
	hide()



func _on_HSlider_value_changed(value: float):
	set_bus_volume(master_bus, value)
	$Panel/volume/HSlider/numvol.text = \"%d%%\" % int(value * 100)

func _on_HSlider2_value_changed(value: float):
	set_bus_volume(menu_music_bus, value)
	$Panel/music/HSlider2/numvol2.text = \"%d%%\" % int(value * 100)

	
func set_bus_volume(bus_index: int,value: float):
		AudioServer.set_bus_volume_db(bus_index, linear2db(value))
		AudioServer.set_bus_mute(bus_index,value < 0.01)

func stop_music():
	if menu_music_player.playing:
		menu_music_player.stop()
"

[sub_resource type="DynamicFontData" id=15]
font_path = "res://assets/ALGER.TTF"

[sub_resource type="DynamicFont" id=23]
size = 56
font_data = SubResource( 15 )

[sub_resource type="DynamicFontData" id=17]
font_path = "res://assets/ALGER.TTF"

[sub_resource type="DynamicFont" id=24]
size = 33
font_data = SubResource( 17 )

[sub_resource type="DynamicFontData" id=19]
font_path = "res://assets/ALGER.TTF"

[sub_resource type="DynamicFont" id=25]
size = 25
font_data = SubResource( 19 )

[sub_resource type="StyleBoxFlat" id=26]
corner_radius_top_left = 331
corner_radius_top_right = 331
corner_radius_bottom_right = 331
corner_radius_bottom_left = 331

[sub_resource type="DynamicFontData" id=22]
font_path = "res://assets/ALGER.TTF"

[sub_resource type="DynamicFont" id=27]
size = 25
font_data = SubResource( 22 )

[node name="Control" type="Control"]
anchor_right = 1.0
anchor_bottom = 1.0
script = SubResource( 28 )

[node name="Panel" type="Panel" parent="."]
margin_left = 294.0
margin_top = 259.0
margin_right = 776.0
margin_bottom = 558.0

[node name="Label" type="Label" parent="Panel"]
margin_left = 133.0
margin_top = 2.0
margin_right = 350.0
margin_bottom = 65.0
custom_fonts/font = SubResource( 23 )
text = "Options"

[node name="Back" type="Button" parent="Panel"]
margin_left = 168.0
margin_top = 240.0
margin_right = 325.0
margin_bottom = 284.0
custom_fonts/font = SubResource( 24 )
text = "Back"

[node name="volume" type="Label" parent="Panel"]
margin_left = 17.0
margin_top = 65.0
margin_right = 111.0
margin_bottom = 94.0
custom_fonts/font = SubResource( 25 )
text = "Volume"

[node name="HSlider" type="HSlider" parent="Panel/volume"]
margin_left = 114.0
margin_top = -11.0
margin_right = 379.0
margin_bottom = 42.0
input_pass_on_modal_close_click = false
custom_styles/grabber_area_highlight = SubResource( 26 )
max_value = 1.0
step = 0.01
value = 0.5

[node name="numvol" type="Label" parent="Panel/volume/HSlider"]
margin_left = 272.0
margin_top = 10.0
margin_right = 338.0
margin_bottom = 39.0
custom_fonts/font = SubResource( 27 )
text = "50 %"

[node name="music" type="Label" parent="Panel"]
margin_left = 20.0
margin_top = 109.0
margin_right = 114.0
margin_bottom = 138.0
custom_fonts/font = SubResource( 25 )
text = "Music"

[node name="HSlider2" type="HSlider" parent="Panel/music"]
margin_left = 114.0
margin_top = -11.0
margin_right = 379.0
margin_bottom = 42.0
input_pass_on_modal_close_click = false
custom_styles/grabber_area_highlight = SubResource( 26 )
max_value = 1.0
step = 0.01
value = 0.5

[node name="numvol2" type="Label" parent="Panel/music/HSlider2"]
margin_left = 272.0
margin_top = 10.0
margin_right = 338.0
margin_bottom = 39.0
custom_fonts/font = SubResource( 27 )
text = "50 %"

[node name="Menu_MusicPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource( 2 )
autoplay = true
bus = "Menu_Music"

[connection signal="pressed" from="Panel/Back" to="." method="_on_Back_pressed"]
[connection signal="value_changed" from="Panel/volume/HSlider" to="." method="_on_HSlider_value_changed"]
[connection signal="value_changed" from="Panel/music/HSlider2" to="." method="_on_HSlider2_value_changed"]
